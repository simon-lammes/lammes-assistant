<ion-header>
  <ion-toolbar>
    <ion-title>{{ 'notes' | translate | titlecase }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list *ngIf="filterForm" [formGroup]="filterForm">
    <ion-list-header>
      <h3>{{ 'filter.noun' | translate | titlecase }}</h3>
    </ion-list-header>
    <app-group-select formControlName="groupIds" [label]="'groups' | translate | titlecase"
                      [noSelectionText]="'messages.no-group-filter' | translate"></app-group-select>
    <ion-item>
      <ion-label>{{ 'note-status' | translate | titlecase }}</ion-label>
      <ion-select formControlName="noteStatus" multiple placeholder="({{ 'optional' | translate | titlecase }})">
        <ion-select-option value="deferred">{{ 'deferred' | translate | titlecase }}</ion-select-option>
        <ion-select-option value="pending">{{ 'pending' | translate | titlecase }}</ion-select-option>
        <ion-select-option value="resolved">{{ 'resolved' | translate | titlecase }}</ion-select-option>
      </ion-select>
    </ion-item>
    <app-label-selector heading="{{ 'labels' | translate | titlecase }}" formControlName="labels"
                        [noSelectionText]="'messages.no-label-filter' | translate"></app-label-selector>
  </ion-list>

  <ion-list>
    <ion-list-header>
      <h3>{{ 'notes' | translate | titlecase }}</h3>
    </ion-list-header>
    <ion-item-sliding *ngFor="let note of filteredNotes$ | async">
      <ion-item-options side="start">
        <ion-item-option *ngIf="!note.resolvedTimestamp" expandable="true" color="success" (click)="resolveNote(note)">
          <ion-icon slot="start" name="checkmark-outline"></ion-icon>
          {{ 'resolve' | translate | titlecase }}
        </ion-item-option>
        <ion-item-option *ngIf="note.resolvedTimestamp" expandable="true" (click)="reopenNote(note)">
          <ion-icon name="arrow-undo-outline"></ion-icon>
          {{ 'reopen' | translate | titlecase }}
        </ion-item-option>
      </ion-item-options>
      <ion-item button (click)="editNote(note)">
        <ion-label>
          <h2>{{note.title}}</h2>
          <ng-container [ngSwitch]="getUrgencyStatus(note)">
            <h3 *ngSwitchCase="UrgencyStatus.Resolved" style="color: var(--ion-color-success)">
              {{ 'resolved-on' | translate }} {{note.resolvedTimestamp | date:'short' }}
            </h3>
            <h3 *ngSwitchCase="UrgencyStatus.Overdue" style="color: var(--ion-color-danger)">
              {{ 'overdue-since' | translate }} {{note.deadlineTimestamp | date:'short' }}
            </h3>
            <h3 *ngSwitchCase="UrgencyStatus.DueSoon" style="color: var(--ion-color-warning)">
              {{ 'urgently-due-till' | translate }} {{note.deadlineTimestamp | date:'short' }}
            </h3>
            <h3 *ngSwitchCase="UrgencyStatus.DueSometime">
              {{ 'due-till' | translate }} {{note.deadlineTimestamp | date:'short' }}
            </h3>
            <h3 *ngSwitchCase="UrgencyStatus.Deferred">
              {{ 'deferred-till' | translate }} {{note.startTimestamp | date:'short' }}
            </h3>
            <h3 *ngSwitchCase="UrgencyStatus.NoStartTimeOrDeadline">
              {{ 'no-start-time' | translate | titlecase }}
            </h3>
          </ng-container>
          <p *ngIf="note.description">{{note.description}}</p>
        </ion-label>
      </ion-item>
    </ion-item-sliding>
  </ion-list>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button (click)="createNote()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
